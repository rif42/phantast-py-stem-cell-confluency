---
description: You are helping the user create a screen design for a section of their product. This uses Stitch.ai to generate a Figma prototype, which is then implemented as a PyQt component.
---

# Design Screen

You are helping the user create a screen design for a section of their product. The screen design will be a PyQt component based on a Figma prototype generated via Stitch.ai.

## Step 1: Check Prerequisites

First, identify the target section and verify that `spec.md`, `data.json`, and `types.ts` all exist.

Read `/product/product-roadmap.md` to get the list of available sections.

If there's only one section, auto-select it. If there are multiple sections, use the AskUserQuestion tool to ask which section the user wants to create a screen design for.

Then verify all required files exist:

- `product/sections/[section-id]/spec.md`
- `product/sections/[section-id]/data.json`
- `product/sections/[section-id]/types.ts`

If spec.md doesn't exist:

"I don't see a specification for **[Section Title]** yet. Please run `/shape-section` first to define the section's requirements."

If data.json or types.ts don't exist:

"I don't see sample data for **[Section Title]** yet. Please run `/sample-data` first to create sample data and types for the screen designs."

Stop here if any file is missing.

## Step 2: Check for Design System

Check for optional enhancements:

**Design Tokens:**
- Check if `/product/design-system/colors.json` exists
- Check if `/product/design-system/typography.json` exists

If design tokens exist, read them. They will be included in the prompt for Stitch.ai.

## Step 3: Analyze Requirements

Read and analyze all three files:

1. **spec.md** - Understand the user flows and UI requirements
2. **data.json** - Understand the data structure and sample content
3. **types.ts** - Understand the TypeScript/Python interfaces and available callbacks

Identify what views are needed based on the spec. Common patterns:

- List/dashboard view (showing multiple items)
- Detail view (showing a single item)
- Form/create view (for adding/editing)

## Step 4: Generate Stitch.ai Prompt

Based on the requirements and design tokens, generate a detailed prompt that the user can copy and paste into Stitch.ai to generate the UI design.

"Please use the following prompt with Stitch.ai to generate the design for **[Section Title]**:

```
Design a desktop application screen for [Section Title].
Purpose: [One sentence description from spec.md]

Design Style:
- Modern, clean desktop UI suitable for a PyQt application.
- Primary Color: [Primary Color from tokens]
- Secondary Color: [Secondary Color from tokens]
- Neutral Color: [Neutral Color from tokens]
- Typography: [Heading Font] for headers, [Body Font] for text.

Requirements:
[List key UI requirements from spec.md]
- [Requirement 1]
- [Requirement 2]
...

Layout:
[Describe preferred layout - e.g., sidebar, split pane, master-detail]

Data to Display:
[List key data fields from data.json]
```

Copy this prompt to Stitch.ai, generating the design in Figma. Once you have the design ready, please provide the **Figma URL** or **paste screenshots** of the design here."

## Step 5: Wait for User Input

Use `AskUserQuestion` to wait for the Figma URL or screenshots.

"I'm ready when you are! Please paste the **Figma URL** or **upload screenshots** of the design generated by Stitch.ai."

## Step 6: Implement PyQt Component

Once you receive the visual reference (screens/URL):

1.  **Analyze the Visuals:** Identify the layout structure (QVBoxLayout, QHBoxLayout, QGridLayout), widgets (QLabel, QPushButton, QLineEdit, QTableView, etc.), and styling details.
2.  **Generate PyQt Code:** Write the Python code using `PySide6`.

Create the component file at `src/sections/[section-id]/views/[ViewName].py`.

### Component Structure

The component MUST:
- Import types/constants if needed.
- Accept data via `__init__` or `set_data` methods.
- Emit signals for user interactions (instead of callbacks).
- Be fully self-contained.

Example:

```python
from PySide6.QtWidgets import QWidget, QVBoxLayout, QLabel, QPushButton, QHBoxLayout
from PySide6.QtCore import Signal, Qt

class InvoiceListWidget(QWidget):
    view_invoice = Signal(str) # invoice_id
    edit_invoice = Signal(str)
    delete_invoice = Signal(str)
    create_invoice = Signal()

    def __init__(self, invoices=None):
        super().__init__()
        self.invoices = invoices or []
        self.init_ui()

    def init_ui(self):
        layout = QVBoxLayout()
        # header
        header_layout = QHBoxLayout()
        header_layout.addWidget(QLabel("Invoices"))
        create_btn = QPushButton("Create Invoice")
        create_btn.clicked.connect(self.create_invoice.emit)
        header_layout.addWidget(create_btn)
        layout.addLayout(header_layout)

        # list
        for invoice in self.invoices:
             # create list item widget...
             pass
        
        self.setLayout(layout)
        self.apply_styles()

    def apply_styles(self):
        # Apply QSS based on design tokens
        self.setStyleSheet("""
            QLabel { font-weight: bold; }
            QPushButton { background-color: blue; color: white; }
        """)
```

### Design Requirements

- **Responsive:** Use layouts meant for resizing.
- **Styling:** Use `setStyleSheet` with QSS (Qt Style Sheets) to match the Figma design as closely as possible.
- **Signals:** Use `PySide6.QtCore.Signal` for all events.

## Step 7: Create Preview Wrapper (main.py)

Create a runnable script `src/sections/[section-id]/[ViewName]_preview.py` to run this specific view independently.

```python
import sys
import json
from PySide6.QtWidgets import QApplication
from views.[ViewName] import [ComponentClass]

# Load sample data
with open('../../product/sections/[section-id]/data.json') as f:
    data = json.load(f)

app = QApplication(sys.argv)
window = [ComponentClass](data['invoices']) # Adjust based on data structure
window.show()
sys.exit(app.exec())
```

## Step 8: Confirm and Next Steps

Let the user know:

"I've created the PyQt screen design for **[Section Title]**:

**Files:**
- `src/sections/[section-id]/views/[ViewName].py` - The reusable component.
- `src/sections/[section-id]/[ViewName]_preview.py` - Runnable preview script.

**How to Run:**
 Run `python src/sections/[section-id]/[ViewName]_preview.py` to see the design in action.

**Next steps:**
- Run `/screenshot-design` to capture a screenshot of this screen.
- Iterate if needed."

## Important Notes

- **Stitch.ai & Figma:** This workflow relies on the user performing the creative design step in Stitch.ai/Figma.
- **PySide6:** Use PySide6 as the binding.
- **QSS:** Use Qt Style Sheets for styling.
